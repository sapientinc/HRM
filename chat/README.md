# HRM チャットアプリケーション

このアプリケーションは、Hierarchical Reasoning Model (HRM) と対話するためのWebインターフェースを提供します。

**【重要】** このアプリケーションは、モデルのアーキテクチャを読み込み推論を実行する骨格（スケルトン）です。意味のある応答を得るためには、**学習済みのモデルチェックポイント (`.pth` ファイル)** と、学習時に使用した**語彙ファイル (`vocab.json`)** が必要です。これらがない場合、アプリはランダムな初期化重みで動作し、無意味な応答を返します。

## 1. 環境構築

以下の手順で、ローカル環境にアプリケーションをセットアップします。

### a. 仮想環境の作成と有効化

```bash
# Python 3.12 を使用
python3.12 -m venv venv
source venv/bin/activate
```

### b. 必要なライブラリのインストール

リポジトリのルートにある `requirements.txt` を使用して、必要なライブラリをインストールします。

```bash
# リポジトリのルートディレクトリに移動していることを確認
pip install -r requirements.txt

# このチャットアプリに必要な追加ライブラリをインストール
pip install gradio torch omegaconf pyyaml
```

## 2. 必要なファイルの準備

アプリケーションを正しく実行するには、以下のファイルを `chat/` ディレクトリに配置する必要があります。

1.  **モデルチェックポイント**: 学習済みのモデルの重みファイルです。ファイル名を `model_checkpoint.pth` に変更して、`chat/` ディレクトリに配置してください。

2.  **語彙ファイル**: 学習時に使用した語彙（トークンとIDの対応）が保存されたJSONファイルです。ファイル名を `vocab.json` に変更して、`chat/` ディレクトリに配置してください。
    - `vocab.json` の例:
      ```json
      {
        "a": 0,
        "b": 1,
        "c": 2,
        ...
      }
      ```

## 3. 使い方

環境構築とファイルの準備が完了したら、以下のコマンドでWebアプリケーションを起動します。

```bash
# chat/ ディレクトリにいることを確認
cd chat

# アプリケーションを起動
python -m chat.chat_app
```

起動後、ターミナルに表示されるURL（例: `http://127.0.0.1:7860`）にブラウザでアクセスすると、チャット画面が表示されます。

テキストボックスにメッセージを入力し、Enterキーを押すか送信ボタンをクリックすると、モデルからの応答が表示されます。
